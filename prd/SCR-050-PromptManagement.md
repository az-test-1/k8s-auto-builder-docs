# SCR-050: 프롬프트 관리

> **Status**: Draft
> **Version**: 1.0.0
> **Last Updated**: 2026-01-13
> **Parent**: [PRD-020-AI-LLM](./PRD-020-AI-LLM.md)

---

## 1. 개요

### 1.1 화면 정보
| 항목 | 내용 |
|------|------|
| 화면 ID | SCR-050 |
| 화면명 | 프롬프트 관리 |
| URL | `/admin/prompts` |
| 접근 권한 | ADMIN |

### 1.2 목적
LLM 에러 수정에 사용되는 프롬프트 템플릿을 관리합니다.

---

## 2. 필수 입력 요약

### 2.1 프롬프트 필드 필수 여부

| 필드명 | 필수 | 조건 | 기본값 | 사용자 입력 |
|--------|:----:|------|--------|:-----------:|
| **name** (프롬프트명) | **Y** | - | - | Y |
| **type** (유형) | **Y** | - | LIB | Y |
| description (설명) | N | - | "" | Y |
| **content** (프롬프트 내용) | **Y** | - | 타입별 기본 템플릿 | Y |
| version (버전) | Y | - | 1 | N (자동) |
| status (상태) | Y | - | ACTIVE | N (자동) |

### 2.2 프롬프트 유형 정의 (실제 사용중)

> ⚠️ **중요**: 아래 3가지 유형만 실제 시스템에서 사용됩니다.

| 유형 코드 | 표시명 | 한글명 | 파이프라인 단계 | 용도 |
|-----------|--------|--------|-----------------|------|
| **`LIB`** | Dependency | 의존성 수정 | OPENREWRITE 후 | pom.xml/build.gradle 의존성을 Spring Boot 3.4/Java 17에 맞게 업데이트 |
| **`SQL`** | SQL | SQL 변환 | SQL 단계 | MariaDB SQL을 PostgreSQL 호환 쿼리로 변환 (MyBatis, JPA, Native Query) |
| **`BUILD`** | SpringBoot | 빌드 에러 수정 | BUILD_LLM 단계 | Java/Spring Boot 업그레이드 시 발생하는 컴파일 에러 수정 |

### 2.3 유형별 태그(변수) 정의

각 프롬프트 유형은 고유한 플레이스홀더 태그를 사용합니다. 실행 시 시스템이 자동으로 값을 주입합니다.

#### LIB (Dependency) 유형 태그

| 태그 | 한글명 | 필수 | 설명 |
|------|--------|:----:|------|
| `{{__INIT_BUILD_LIB__}}` | 초기 빌드 라이브러리 파일 | **Y** | 최초 pom.xml 또는 build.gradle 내용 |
| `{{__REWRITE_BUILD_LIB__}}` | OpenRewrite 후 빌드 파일 | **Y** | OpenRewrite 적용 후 pom.xml/build.gradle |

#### SQL 유형 태그

| 태그 | 한글명 | 필수 | 설명 |
|------|--------|:----:|------|
| `{{__SQL_FILE__}}` | SQL 파일 | **Y** | 수정이 필요한 SQL 파일 내용 (MyBatis mapper, JPA, Native Query) |

#### BUILD (SpringBoot) 유형 태그

| 태그 | 한글명 | 필수 | 설명 |
|------|--------|:----:|------|
| `{{__dependency_info__}}` | 현재 의존성 파일 | **Y** | 현재 pom.xml 또는 build.gradle |
| `{{__fewshot_info__}}` | LLM이 선택한 퓨샷 | N | 프로젝트 태그에 속한 퓨샷 중 LLM이 선택한 예제 |
| `{{__error_info__}}` | 현재 발생한 에러로그 | **Y** | 현재 파일에서 발생한 컴파일 에러 전체 |
| `{{__reference_section__}}` | 참고할 파일 | N | 에러 수정 시 참고할 관련 파일 |
| `{{__code_content__}}` | 수정할 소스코드 전체 | **Y** | 현재 수정해야 할 소스코드 전체 |
| `{{__fix_history_section__}}` | 해당 파일 수정이력 | N | 빌드 횟수 동안 LLM을 통해 수정한 히스토리 |

### 2.4 유형별 필수 태그 매트릭스

| 태그 | LIB | SQL | BUILD |
|------|:---:|:---:|:-----:|
| `{{__INIT_BUILD_LIB__}}` | **Y** | - | - |
| `{{__REWRITE_BUILD_LIB__}}` | **Y** | - | - |
| `{{__SQL_FILE__}}` | - | **Y** | - |
| `{{__dependency_info__}}` | - | - | **Y** |
| `{{__error_info__}}` | - | - | **Y** |
| `{{__code_content__}}` | - | - | **Y** |
| `{{__fewshot_info__}}` | - | - | N |
| `{{__reference_section__}}` | - | - | N |
| `{{__fix_history_section__}}` | - | - | N |

> **Y** = 필수, **N** = 선택, **-** = 해당 없음

### 2.5 미사용 유형 (레거시/문서용)

> ⚠️ 아래 유형들은 초기 설계에 포함되었으나 현재 시스템에서 **사용되지 않습니다**.

| 유형 코드 | 상태 | 비고 |
|-----------|------|------|
| ~~ERROR_ANALYSIS~~ | 미사용 | BUILD 유형으로 통합됨 |
| ~~CODE_FIX~~ | 미사용 | BUILD 유형으로 통합됨 |
| ~~BUILD_VERIFY~~ | 미사용 | BUILD 유형으로 통합됨 |
| ~~COMPREHENSIVE~~ | 미사용 | BUILD 유형으로 통합됨 |
| ~~SQL_CONVERT~~ | 미사용 | SQL 유형으로 변경됨 |

---

## 3. 화면 구성

### 3.1 와이어프레임

```
┌─────────────────────────────────────────────────────────────────┐
│ 프롬프트 관리                                      [+ 프롬프트 생성] │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 🔍 검색...          │ 유형 [전체 ▼] │ 상태 [전체 ▼]      │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 프롬프트명            │ 유형        │ 버전 │ 상태 │ 수정일 │ 액션│
│  ├─────────────────────────────────────────────────────────┤    │
│  │ 📝 의존성 수정 프롬프트 │ LIB          │ v3  │ ✓   │ 01-13 │ ⋮  │    │
│  │ 📝 SQL 변환 프롬프트   │ SQL          │ v2  │ ✓   │ 01-12 │ ⋮  │    │
│  │ 📝 빌드 에러 수정      │ BUILD        │ v5  │ ✓   │ 01-10 │ ⋮  │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 총 3개                              ◀ 1 ▶  10개씩 [▼]   │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 프롬프트 편집 화면

```
┌─────────────────────────────────────────────────────────────────┐
│ ← 프롬프트 목록                                                  │
│                                                                 │
│ 📝 의존성 수정 프롬프트                              [저장] [테스트]│
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 기본 정보                                                │    │
│  │ ────────────────────────────────────────────────────    │    │
│  │                                                         │    │
│  │ 프롬프트명 *                                             │    │
│  │ ┌─────────────────────────────────────────────────┐     │    │
│  │ │ 의존성 수정 프롬프트                             │     │    │
│  │ └─────────────────────────────────────────────────┘     │    │
│  │                                                         │    │
│  │ 유형 *                             버전: v3             │    │
│  │ ┌─────────────────────────────────────────────────┐     │    │
│  │ │ LIB (Dependency)                              ▼ │     │    │
│  │ └─────────────────────────────────────────────────┘     │    │
│  │                                                         │    │
│  │ 설명                                                    │    │
│  │ ┌─────────────────────────────────────────────────┐     │    │
│  │ │ pom.xml/build.gradle 의존성 업데이트 프롬프트    │     │    │
│  │ └─────────────────────────────────────────────────┘     │    │
│  │                                                         │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 프롬프트 내용                                            │    │
│  │ ────────────────────────────────────────────────────    │    │
│  │                                                         │    │
│  │ ┌─────────────────────────────────────────────────┐     │    │
│  │ │ Spring Boot 2.7 → 3.4 마이그레이션 중입니다.     │     │    │
│  │ │                                                 │     │    │
│  │ │ 요청사항:                                       │     │    │
│  │ │ 1. 현재 build.gradle을 검토하여 Spring Boot 3.4 │     │    │
│  │ │    호환되지 않는 의존성 버전 확인               │     │    │
│  │ │ 2. MavenCentral에 존재하는 버전으로 변경       │     │    │
│  │ │                                                 │     │    │
│  │ │ ##최초 build.gradle                            │     │    │
│  │ │ {{__INIT_BUILD_LIB__}}                         │     │    │
│  │ │                                                 │     │    │
│  │ │ ##현재 build.gradle                            │     │    │
│  │ │ {{__REWRITE_BUILD_LIB__}}                      │     │    │
│  │ │                                                 │     │    │
│  │ │ 출력형식: 수정된 build.gradle 코드만 제공       │     │    │
│  │ └─────────────────────────────────────────────────┘     │    │
│  │                                                         │    │
│  │ 사용 가능한 태그 (LIB 유형):                             │    │
│  │ {{__INIT_BUILD_LIB__}} {{__REWRITE_BUILD_LIB__}}        │    │
│  │                                                         │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ 연결된 Few-shot 예제                         [+ 연결]    │    │
│  │                                                         │    │
│  │ ┌───────────────────────────────────────────────────┐   │    │
│  │ │ 📎 NPE 수정 예제             │ 5개 샘플 │ [해제]   │   │    │
│  │ │ 📎 타입 캐스팅 예제          │ 3개 샘플 │ [해제]   │   │    │
│  │ └───────────────────────────────────────────────────┘   │    │
│  │                                                         │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 3.3 테스트 모달

```
┌─────────────────────────────────────────────────────────────┐
│ 프롬프트 테스트                                               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 테스트 입력                                                  │
│ ─────────────────────────────────────────────────────────   │
│                                                             │
│ error_message *                                             │
│ ┌─────────────────────────────────────────────────────┐     │
│ │ cannot find symbol: method getConnection()          │     │
│ └─────────────────────────────────────────────────────┘     │
│                                                             │
│ source_code *                                               │
│ ┌─────────────────────────────────────────────────────┐     │
│ │ Connection conn = dataSource.getConnection();       │     │
│ └─────────────────────────────────────────────────────┘     │
│                                                             │
│ ┌─────────────────────────────────────────────────────┐     │
│ │                                      [실행]         │     │
│ └─────────────────────────────────────────────────────┘     │
│                                                             │
│ LLM 응답                                                    │
│ ─────────────────────────────────────────────────────────   │
│ ┌─────────────────────────────────────────────────────┐     │
│ │ ## 에러 원인                                        │     │
│ │ Java 17에서 DataSource.getConnection() 메서드의     │     │
│ │ 시그니처가 변경되었습니다...                         │     │
│ │                                                     │     │
│ │ ## 수정 방법                                        │     │
│ │ try-with-resources 구문을 사용하여...               │     │
│ │                                                     │     │
│ │ ## 수정된 코드                                      │     │
│ │ ```java                                            │     │
│ │ try (Connection conn = dataSource.getConnection()) │     │
│ │ ```                                                │     │
│ └─────────────────────────────────────────────────────┘     │
│                                                             │
│ 토큰 사용량: 입력 245 / 출력 312  │  소요시간: 2.3초         │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                                              [닫기]          │
└─────────────────────────────────────────────────────────────┘
```

---

## 4. 기능 정의

### 4.1 목록 조회

| ID | 기능 | 설명 |
|----|------|------|
| F050-01 | 프롬프트 목록 | 전체 프롬프트 테이블 표시 |
| F050-02 | 검색 | 프롬프트명으로 검색 |
| F050-03 | 유형 필터 | 프롬프트 유형별 필터 |
| F050-04 | 상태 필터 | 활성/비활성 필터 |

### 4.2 프롬프트 관리

| ID | 기능 | 설명 |
|----|------|------|
| F050-05 | 프롬프트 생성 | 새 프롬프트 생성 |
| F050-06 | 프롬프트 편집 | 프롬프트 내용 수정 |
| F050-07 | 버전 관리 | 수정 시 버전 자동 증가 |
| F050-08 | 활성화/비활성화 | 프롬프트 상태 변경 |
| F050-09 | 삭제 | 프롬프트 삭제 |
| F050-10 | 복제 | 기존 프롬프트 복제 |

### 4.3 편집 기능

| ID | 기능 | 설명 |
|----|------|------|
| F050-11 | 변수 삽입 | 사용 가능한 변수 삽입 |
| F050-12 | 문법 하이라이트 | 마크다운/코드 하이라이트 |
| F050-13 | 미리보기 | 변수 치환 미리보기 |

### 4.4 테스트 기능

| ID | 기능 | 설명 |
|----|------|------|
| F050-14 | 테스트 실행 | 샘플 입력으로 LLM 호출 |
| F050-15 | 결과 확인 | LLM 응답 결과 표시 |
| F050-16 | 토큰 사용량 | 입출력 토큰 수 표시 |

### 4.5 Few-shot 연결

| ID | 기능 | 설명 |
|----|------|------|
| F050-17 | Few-shot 연결 | 예제 세트 연결 |
| F050-18 | Few-shot 해제 | 연결 해제 |
| F050-19 | 순서 조정 | 예제 적용 순서 조정 |

---

## 4. 입력 필드 요약

| 필드 | 타입 | 필수 | 검증 규칙 |
|------|------|:----:|----------|
| 프롬프트명 | text | Y | 2-100자 |
| 유형 | select | Y | 정의된 유형 중 선택 |
| 설명 | textarea | N | 최대 500자 |
| 내용 | textarea | Y | 최대 10,000자 |

---

## 5. 상세 필드 정의

### 5.1 name (프롬프트명)

| 항목 | 내용 |
|------|------|
| **필드명** | name |
| **한글명** | 프롬프트명 |
| **데이터 타입** | String |
| **필수 여부** | Y |
| **최소 길이** | 2자 |
| **최대 길이** | 100자 |
| **허용 문자** | 모든 유니코드 문자 (한글, 영문, 숫자, 특수문자) |
| **기본값** | 없음 |
| **고유성** | 시스템 전체에서 유일해야 함 |
| **정의** | 프롬프트 템플릿을 식별하는 고유 이름. 관리자가 프롬프트를 구분하고 관리하는 데 사용 |
| **예시** | `에러 분석 프롬프트`, `Java 17 코드 수정 프롬프트`, `SQL 변환 v2` |

### 5.2 type (유형)

| 항목 | 내용 |
|------|------|
| **필드명** | type |
| **한글명** | 유형 |
| **데이터 타입** | Enum (String) |
| **필수 여부** | Y |
| **허용 값** | `LIB`, `SQL`, `BUILD` |
| **기본값** | `LIB` |
| **정의** | 프롬프트의 용도와 사용 시점을 결정하는 분류. 마이그레이션 파이프라인에서 적절한 프롬프트를 자동 선택하는 데 사용 |

#### 유형별 상세 정의

| 유형 코드 | 표시명 | 한글명 | 파이프라인 단계 | 목적 |
|-----------|--------|--------|-----------------|------|
| `LIB` | Dependency | 의존성 수정 | OPENREWRITE 후 | pom.xml/build.gradle 의존성을 Spring Boot 3.4/Java 17에 맞게 업데이트. MavenCentral 검증 |
| `SQL` | SQL | SQL 변환 | SQL 단계 | MariaDB SQL을 PostgreSQL 호환으로 변환 (MyBatis mapper, JPA JPQL, Native Query) |
| `BUILD` | SpringBoot | 빌드 에러 수정 | BUILD_LLM 단계 | Java/Spring Boot 업그레이드 컴파일 에러 분석 및 소스코드 수정 |

#### 유형별 기본 프롬프트 템플릿

각 유형 선택 시 시스템이 제공하는 기본 템플릿이 자동 적용됩니다. 관리자는 이를 커스터마이징할 수 있습니다.

| 유형 | 기본 템플릿 요약 |
|------|------------------|
| `LIB` | Spring Boot 2.7→3.4 마이그레이션용 build.gradle/pom.xml 수정 가이드 |
| `SQL` | MariaDB→PostgreSQL 변환 가이드 (SQL 인젝션 방지 포함) |
| `BUILD` | Java 업그레이드 컴파일 에러 수정 가이드 (퓨샷 참고, 수정이력 활용) |

### 5.3 description (설명)

| 항목 | 내용 |
|------|------|
| **필드명** | description |
| **한글명** | 설명 |
| **데이터 타입** | String (Text) |
| **필수 여부** | N |
| **최대 길이** | 500자 |
| **기본값** | 빈 문자열 ("") |
| **정의** | 프롬프트의 용도, 특징, 사용 시 주의사항 등을 기록하는 메모 필드 |
| **예시** | `Java 8에서 17로 마이그레이션 시 발생하는 API 변경 에러를 분석하는 프롬프트` |

### 5.4 content (프롬프트 내용)

| 항목 | 내용 |
|------|------|
| **필드명** | content |
| **한글명** | 프롬프트 내용 |
| **데이터 타입** | String (Text/Markdown) |
| **필수 여부** | Y |
| **최소 길이** | 10자 |
| **최대 길이** | 10,000자 |
| **허용 형식** | 일반 텍스트, Markdown, 변수 플레이스홀더 (`{{variable}}`) |
| **정의** | LLM에 전달되는 실제 프롬프트 템플릿. 변수 플레이스홀더를 포함하며, 실행 시 실제 값으로 치환됨 |
| **필수 포함 요소** | - 역할 정의 (예: "당신은 Java 전문가입니다")<br>- 작업 지시<br>- 입력 데이터 변수<br>- 출력 형식 명시 |

### 5.5 version (버전)

| 항목 | 내용 |
|------|------|
| **필드명** | version |
| **한글명** | 버전 |
| **데이터 타입** | Integer |
| **필수 여부** | Y (자동 생성) |
| **기본값** | 1 |
| **자동 증가** | content 수정 시 자동으로 +1 |
| **정의** | 프롬프트 변경 이력을 추적하기 위한 버전 번호. 수정할 때마다 자동 증가 |

### 5.6 status (상태)

| 항목 | 내용 |
|------|------|
| **필드명** | status |
| **한글명** | 상태 |
| **데이터 타입** | Enum (String) |
| **필수 여부** | Y |
| **허용 값** | `ACTIVE`, `INACTIVE` |
| **기본값** | `ACTIVE` |
| **정의** | 프롬프트의 활성화 상태. INACTIVE 상태의 프롬프트는 마이그레이션 실행 시 사용되지 않음 |

---

## 6. 프롬프트 태그 상세 정의

> ⚠️ 태그는 프롬프트 유형별로 다릅니다. 해당 유형에 속한 태그만 사용하세요.

### 6.1 태그 요약

| 태그 | 유형 | 필수 | 설명 |
|------|------|:----:|------|
| `{{__INIT_BUILD_LIB__}}` | LIB | **Y** | 최초 빌드 파일 (pom.xml/build.gradle) |
| `{{__REWRITE_BUILD_LIB__}}` | LIB | **Y** | OpenRewrite 적용 후 빌드 파일 |
| `{{__SQL_FILE__}}` | SQL | **Y** | 변환 대상 SQL 파일 내용 |
| `{{__dependency_info__}}` | BUILD | **Y** | 현재 의존성 파일 |
| `{{__error_info__}}` | BUILD | **Y** | 컴파일 에러 로그 |
| `{{__code_content__}}` | BUILD | **Y** | 수정 대상 소스코드 |
| `{{__fewshot_info__}}` | BUILD | N | LLM이 선택한 퓨샷 예제 |
| `{{__reference_section__}}` | BUILD | N | 참고 파일 내용 |
| `{{__fix_history_section__}}` | BUILD | N | 해당 파일 수정 이력 |

---

### 6.2 LIB 유형 태그

#### 6.2.1 __INIT_BUILD_LIB__ (초기 빌드 파일)

| 항목 | 내용 |
|------|------|
| **태그** | `{{__INIT_BUILD_LIB__}}` |
| **한글명** | 초기 빌드 라이브러리 파일 |
| **소속 유형** | LIB |
| **필수 여부** | Y |
| **소스** | 프로젝트 업로드 시 원본 빌드 파일 |
| **정의** | 마이그레이션 전 최초 pom.xml 또는 build.gradle 파일 내용. LLM이 변경 전 상태를 참고하여 호환성 유지 |
| **예시** | 원본 build.gradle 또는 pom.xml 전체 내용 |

#### 6.2.2 __REWRITE_BUILD_LIB__ (OpenRewrite 후 빌드 파일)

| 항목 | 내용 |
|------|------|
| **태그** | `{{__REWRITE_BUILD_LIB__}}` |
| **한글명** | OpenRewrite 후 빌드 라이브러리 파일 |
| **소속 유형** | LIB |
| **필수 여부** | Y |
| **소스** | OpenRewrite 단계 완료 후 생성된 빌드 파일 |
| **정의** | OpenRewrite 적용 후 pom.xml 또는 build.gradle. LLM이 이를 검토하여 추가 의존성 수정 수행 |
| **예시** | OpenRewrite로 Spring Boot 3.4 업데이트된 build.gradle |

---

### 6.3 SQL 유형 태그

#### 6.3.1 __SQL_FILE__ (SQL 파일)

| 항목 | 내용 |
|------|------|
| **태그** | `{{__SQL_FILE__}}` |
| **한글명** | SQL 파일 |
| **소속 유형** | SQL |
| **필수 여부** | Y |
| **소스** | 프로젝트 내 SQL 포함 파일 (MyBatis mapper, JPA repository 등) |
| **정의** | MariaDB 문법의 SQL이 포함된 파일 내용. LLM이 PostgreSQL 호환 쿼리로 변환 |
| **대상 파일** | - MyBatis XML mapper<br>- JPA @Query 어노테이션<br>- Native Query 사용 코드 |
| **예시** | MyBatis mapper.xml 전체 내용 |

---

### 6.4 BUILD 유형 태그

#### 6.4.1 __dependency_info__ (현재 의존성 파일)

| 항목 | 내용 |
|------|------|
| **태그** | `{{__dependency_info__}}` |
| **한글명** | 현재 의존성 파일 |
| **소속 유형** | BUILD |
| **필수 여부** | Y |
| **소스** | 현재 프로젝트 빌드 파일 |
| **정의** | 현재 pom.xml 또는 build.gradle 내용. LLM이 사용 가능한 라이브러리/버전 확인에 활용 |
| **예시** | 현재 상태의 build.gradle 전체 내용 |

#### 6.4.2 __error_info__ (에러 로그)

| 항목 | 내용 |
|------|------|
| **태그** | `{{__error_info__}}` |
| **한글명** | 현재 발생한 에러로그 |
| **소속 유형** | BUILD |
| **필수 여부** | Y |
| **소스** | Maven/Gradle 빌드 출력에서 추출 |
| **정의** | 현재 파일에서 발생한 컴파일 에러 전체. LLM이 에러 원인 분석 및 수정 방법 결정에 사용 |
| **예시** | `error: cannot find symbol\n  symbol:   method getConnection()` |

#### 6.4.3 __code_content__ (수정할 소스코드)

| 항목 | 내용 |
|------|------|
| **태그** | `{{__code_content__}}` |
| **한글명** | 수정할 소스코드 전체 |
| **소속 유형** | BUILD |
| **필수 여부** | Y |
| **소스** | 에러가 발생한 Java 파일 |
| **정의** | 현재 수정해야 할 소스코드 전체 내용. LLM이 에러를 수정하여 전체 코드 반환 |
| **예시** | UserService.java 전체 내용 |

#### 6.4.4 __fewshot_info__ (퓨샷 예제)

| 항목 | 내용 |
|------|------|
| **태그** | `{{__fewshot_info__}}` |
| **한글명** | LLM이 선택한 퓨샷 |
| **소속 유형** | BUILD |
| **필수 여부** | N |
| **소스** | 프로젝트 태그에 속한 퓨샷 중 LLM이 선택 |
| **정의** | 유사한 에러 수정 예제. LLM이 참고하여 일관된 수정 패턴 적용 |
| **예시** | NPE 수정 예제의 Input/Output 쌍 |

#### 6.4.5 __reference_section__ (참고 파일)

| 항목 | 내용 |
|------|------|
| **태그** | `{{__reference_section__}}` |
| **한글명** | 참고할 파일 |
| **소속 유형** | BUILD |
| **필수 여부** | N |
| **소스** | 에러 수정 시 참고해야 할 관련 파일 |
| **정의** | 현재 수정해야 할 파일에서 에러를 수정하기 위해 참고할 파일들 (인터페이스, 부모 클래스 등) |
| **예시** | BaseService.java, UserRepository.java |

#### 6.4.6 __fix_history_section__ (수정 이력)

| 항목 | 내용 |
|------|------|
| **태그** | `{{__fix_history_section__}}` |
| **한글명** | 해당 소스코드파일 LLM을 통한 수정이력 |
| **소속 유형** | BUILD |
| **필수 여부** | N |
| **소스** | 빌드 횟수 동안 LLM을 통해 수정한 히스토리 |
| **정의** | 동일 파일에 대한 이전 LLM 수정 이력. 반복적 실패 방지 및 일관성 유지에 활용 |
| **예시** | `[시도1] import 변경 → 실패\n[시도2] 메서드 시그니처 수정 → 성공` |

---

## 7. API 연동

### 7.1 프롬프트 목록 조회
```yaml
GET /api/v1/admin/prompts
Query:
  search: string (optional)
  type: string (optional)
  status: string (optional)
Response:
  data:
    result: Prompt[]
    pagination: {...}
```

### 7.2 프롬프트 상세 조회
```yaml
GET /api/v1/admin/prompts/{id}
Response:
  id: string
  name: string
  type: string
  description: string
  content: string
  version: number
  status: string
  linkedFewshots: [{
    id: string
    name: string
    sampleCount: number
  }]
  createdAt: datetime
  updatedAt: datetime
```

### 7.3 프롬프트 생성
```yaml
POST /api/v1/admin/prompts
Body:
  name: string
  type: string
  description: string
  content: string
Response:
  201: Created prompt
```

### 7.4 프롬프트 수정
```yaml
PUT /api/v1/admin/prompts/{id}
Body:
  name: string
  description: string
  content: string
Response:
  200: Updated prompt (version incremented)
```

### 7.5 프롬프트 테스트
```yaml
POST /api/v1/admin/prompts/{id}/test
Body:
  variables: {
    error_message: string
    source_code: string
    ...
  }
Response:
  result: string
  usage:
    inputTokens: number
    outputTokens: number
  duration: number
```

### 7.6 Few-shot 연결
```yaml
POST /api/v1/admin/prompts/{id}/fewshots
Body:
  fewshotIds: string[]
Response:
  200: Linked
```

---

## 8. 상태 관리

```typescript
interface PromptManagementState {
  prompts: Prompt[];
  selectedPrompt: PromptDetail | null;
  editForm: {
    name: string;
    type: string;
    description: string;
    content: string;
  };
  linkedFewshots: Fewshot[];
  testResult: TestResult | null;
  isLoading: boolean;
  isTesting: boolean;
  hasChanges: boolean;
}
```

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|----------|
| 1.0.0 | 2026-01-13 | 초기 작성 |
